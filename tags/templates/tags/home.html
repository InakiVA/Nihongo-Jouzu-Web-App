{% extends "base.html" %}
{% block content %}
<div class="flex flex-col flex-auto px-4 gap-4 pb-4">
  <div class="flex flex-row w-full gap-4 justify-between items-start">
    <h4 class="text-start">Etiquetas</h4>    
    <button type="button" class="button-big" data-open="#crear_etiqueta_modal">
      {% include "components/icons/add.html" %} Nueva Etiqueta
    </button>    
  </div>

  <dialog id="crear_etiqueta_modal" class="modal">
    <div class="modal-box space-y-4">
      <div class="flex flex-row justify-between items-center">
        <h2>Etiqueta a crear</h2>
        <button type="button" class="button-icon-only" data-close="#crear_etiqueta_modal">
          {% include "components/icons/cross.html" %}
        </button>        
      </div>     
      
      <form action="{{ crear_etiqueta_url }}" method="post" class="gap-4 p-4 flex flex-auto flex-col">
        {% csrf_token %}
        <div class="flex flex-auto flex-col gap-2">
            <div class="flex">
                <legend class="fieldset-legend">Etiqueta</legend>
                <legend class="fieldset-legend text-myalert">*</legend>          
            </div>          
            {% include "components/input.html" with placeholder="Tu etiqueta:" name="etiqueta_nueva" value=ajustes_etiquetas.etiqueta_valido%}
        </div>

        <div class="flex flex-auto flex-col">
          <div class="flex">
            <legend class="fieldset-legend">Color</legend>
            <legend class="fieldset-legend text-myalert">*</legend>
          </div>
          <div class="flex flex-row flex-wrap gap-2 py-2 items-center">
            <input type="hidden" name="color_nuevo" value="{{ default_color }}">
            {% include "components/tag_color_selector.html" with name="color_nuevo" selected=default_color submit=False%}
          </div>          
        </div>

        <div class="flex flex-auto pt-8 justify-center">
          {% include "components/button.html" with url=crear_etiqueta_url text="Crear" icon="components/icons/add.html" extra_classes="button-big" %}
        </div>
      </form>      
    </div>
  </dialog>

  <div class="space-y-4">
    {% for tag in tag_list %}  
      <div class="collapse border rounded-none! rounded-tl-3xl! rounded-br-3xl! border-neutral-main">
        <div class="collapse-title flex flex-row gap-4 justify-between">
          {% include "components/tag.html" with color=tag.color text=tag.etiqueta extra_classes="text-2xl"%}
          <h3>{{ tag.creador }}</h3>
        </div>
        {% if tag.editable %}
          <input type="checkbox" />
        {% endif %}
        <div class="collapse-content flex flex-row gap-4 justify-between">
          <div class="h-10 flex flex-auto flex-col">
            <form action="{{ editar_etiqueta_url }}" method="post">
              {% csrf_token %}
              <input type="hidden" name="etiqueta_id" value="{{ tag.id }}">
              {%include "components/input_button.html" with button_text="Editar" value=tag.etiqueta button_classes="button-neutral"  name="update_etiqueta" icon="components/icons/pencil.html" %}
            </form>
          </div>
          <div>
            <form action="{{ editar_color_url }}" method="post">
              {% csrf_token %}
              <input type="hidden" name="etiqueta_id" value="{{ tag.id }}">
              {% include "components/tag_color_selector.html" with name="update_color" value=tag.etiqueta selected=tag.color submit=True%}
            </form>
          </div>
          <div>
            {% include "components/button.html" with name="delete_tag" value=tag.id url=eliminar_etiqueta_url text="Eliminar" icon="components/icons/trash.html" extra_classes="button-alert" %}
          </div>
        </div>
      </div>   
    {% endfor %}
  </div>

  {% if show_pages_list %}
    <div class="flex w-full items-center justify-center">
      {% include "components/pagination.html" with pages=pages_list url=cambiar_pagina_url%}
    </div>
  {% endif %}
  
</div>
{% endblock %}
